import{_ as g}from"./index-094af656.js";import{m as I,t as S,s as q,A as R,d as D}from"./add-72c19175.js";import{aK as K,am as F,_ as N}from"./index-391c66f0.js";import{E as w}from"./index-bb6527ef.js";import{o as U}from"./omit-7cb21f5a.js";import{E as j}from"./index-be857a20.js";import{S as A,r as d,v as L,i as u,o as O,c as Q,k as e,w as s,A as i,j as V,M as b,s as z}from"./core-d086e217.js";import"./pagination-f5b554ba.js";import"./elIcon-e456a308.js";import"./index-c2d633e6.js";import"./index-61c50de1.js";import"./event-9519ab40.js";import"./index-8a321c97.js";import"./index-8842122b.js";import"./scroll-62c8a58b.js";import"./validator-7045813a.js";import"./vue.runtime.esm-bundler-36fda889.js";import"./mock-d5a52175.js";import"./index-7be35ccf.js";import"./index-589bce5d.js";import"./flatten-d075e74e.js";import"./identity-46f208ab.js";import"./index-4d99d7b2.js";import"./dropdown-68e52a79.js";import"./index-1122482a.js";import"./index-32c476c1.js";import"./index-18c42c29.js";import"./index-a03c24b9.js";import"./index-a38d58ec.js";import"./index-96f15593.js";import"./index-27e5bc6b.js";import"./refs-ae9aa695.js";import"./isPlainObject-9a523685.js";const G={clss:"menu"},H=A({setup:!0,name:"Menu",getComponents:()=>[u("vxe-column"),u("mel-icon-edit"),w,u("mel-icon-delete"),g,R]}),J=A({...H,__name:"menu",props:{checkedRules:{type:Array,default:()=>[]}},emits:["subRules"],setup(C,{emit:T}){const v=C,m=d(!1),r=d(),l=I();L(()=>[v.checkedRules,l.data.value],async()=>{!l.data.value||!l.data.value.length||(await r.value.vxeTableRef.clearCheckboxRow(),r.value.vxeTableRef.setCheckboxRow(v.checkedRules.reduce((n,o)=>{const a=r.value.vxeTableRef.getRowById(o);return a.children||n.push(a),n},[]),!0))});let h=[];const p=d(""),x=n=>{l.data.value=K(n,["name","rule"],h),z(()=>r.value.vxeTableRef.setAllTreeExpand(!0))},c=async()=>{await l.runAsync(),h=F(l.data.value),x(r.value.searchText)};c();const k=d(),y=n=>{k.value=n?U(n,["children"]):void 0,m.value=!0},E=n=>{j.confirm("确认删除所选菜单?").then(()=>{D().runAsync(n).then(c)}).catch(()=>{})};return(n,o)=>{const a=u("vxe-column"),B=u("mel-icon-edit"),f=w,M=u("mel-icon-delete"),$=g;return O(),Q("div",G,[e($,{ref_key:"menuRef",ref:r,"quick-search":i(p),"onUpdate:quickSearch":o[1]||(o[1]=t=>b(p)?p.value=t:null),data:i(l).data.value??[],loading:i(l).loading.value,"custom-column":!1,"tree-config":{expandAll:!0,line:!0,reserve:!0},"checkbox-config":{labelField:"id"},"row-config":{keyField:"rule",useKey:!0},"column-config":{useKey:!0},align:"center",border:"","me-class":"table-menu",height:"auto","show-overflow":"",onRefresh:c,onQuickSearch:x,onAdd:o[2]||(o[2]=t=>y())},{toolsButton:s(()=>[e(f,{type:"success",onClick:o[0]||(o[0]=t=>T("subRules",i(r).vxeTableRef.getCheckboxRecords(!0).map(_=>_.rule)))},{default:s(()=>[V("保存")]),_:1})]),default:s(()=>[e(a,{type:"checkbox",title:"ID","tree-node":"",width:"240px",align:"left","header-align":"center"}),e(a,{field:"name",title:"菜单",type:"html"}),e(a,{field:"rule",title:"规则",type:"html"}),e(a,{field:"type",title:"类型",formatter:({row:t})=>S[t.type]},null,8,["formatter"]),e(a,{field:"sort",title:"排序"}),e(a,{field:"status",title:"状态",formatter:({row:t})=>q[t.status]},null,8,["formatter"]),e(a,{title:"操作"},{default:s(({row:t})=>[e(f,{type:"primary",link:"",onClick:_=>y(t)},{default:s(()=>[e(B)]),_:2},1032,["onClick"]),e(f,{type:"danger",link:"",onClick:_=>E(t.id)},{default:s(()=>[e(M)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["quick-search","data","loading"]),e(R,{show:i(m),"onUpdate:show":o[3]||(o[3]=t=>b(m)?m.value=t:null),data:i(k),onSuccess:o[4]||(o[4]=t=>c())},null,8,["show","data"])])}}});const Ee=N(J,[["__scopeId","data-v-766d700b"]]);export{Ee as default};
